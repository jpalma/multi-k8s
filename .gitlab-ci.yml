stages:
  - Test
  - Build and Push
  - Deploy

Test:
  stage: Test
  image: docker:19.03.5
  services:
    - docker:19.03.5-dind
  before_script:
  - docker info
  - docker build -t registry.gitlab.com/shogun-courses/multi-k8s/react-test -f ./client/Dockerfile.dev ./client
  script:
    - docker run -e CI=true registry.gitlab.com/shogun-courses/multi-k8s/react-test npm test
